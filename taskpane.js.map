{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, OfficeRuntime, console, fetch, window */\n\nconst API_KEY_STORAGE_KEY = \"outlookSummarize.openAiKey\";\nconst MAX_EMAIL_CHARACTERS = 6000;\nconst RUN_LABEL_IDLE = \"Summarize email\";\nconst RUN_LABEL_BUSY = \"Summarizing...\";\nconst BUTTON_LABEL_SELECTOR = \"[data-button-label]\";\n\nconst elements = {\n    runButton: null,\n    statusText: null,\n    summaryContainer: null,\n    todoList: null,\n    fyiList: null,\n    apiKeyInput: null,\n    saveKeyButton: null,\n    clearKeyButton: null,\n    apiKeyStatus: null,\n    settingsRoot: null,\n    openSettingsButton: null,\n    closeSettingsButton: null,\n    settingsBackdrop: null\n};\n\nlet settingsReturnFocus = null;\n\nOffice.onReady((info) => {\n    if (info.host === Office.HostType.Outlook) {\n        initializeTaskPane().catch((error) => console.error(\"Failed to initialize task pane\", error));\n    }\n});\n\nasync function initializeTaskPane() {\n    const sideloadMessage = document.getElementById(\"sideload-msg\");\n    const appBody = document.getElementById(\"app-body\");\n\n    if (sideloadMessage) {\n        sideloadMessage.style.display = \"none\";\n    }\n\n    if (appBody) {\n        appBody.style.display = \"flex\";\n    }\n\n    elements.runButton = document.getElementById(\"run\");\n    elements.statusText = document.getElementById(\"status\");\n    elements.summaryContainer = document.getElementById(\"summary\");\n    elements.todoList = document.getElementById(\"todo-list\");\n    elements.fyiList = document.getElementById(\"fyi-list\");\n    elements.apiKeyInput = document.getElementById(\"api-key-input\");\n    elements.saveKeyButton = document.getElementById(\"save-key\");\n    elements.clearKeyButton = document.getElementById(\"clear-key\");\n    elements.apiKeyStatus = document.getElementById(\"api-key-status\");\n    elements.settingsRoot = document.getElementById(\"settings\");\n    elements.openSettingsButton = document.getElementById(\"open-settings\");\n    elements.closeSettingsButton = document.getElementById(\"close-settings\");\n    elements.settingsBackdrop = elements.settingsRoot ? elements.settingsRoot.querySelector(\".settings__backdrop\") : null;\n\n    if (elements.runButton) {\n        elements.runButton.addEventListener(\"click\", run);\n    }\n\n    if (elements.saveKeyButton) {\n        elements.saveKeyButton.addEventListener(\"click\", handleSaveApiKey);\n    }\n\n    if (elements.clearKeyButton) {\n        elements.clearKeyButton.addEventListener(\"click\", handleClearApiKey);\n    }\n\n    if (elements.openSettingsButton) {\n        elements.openSettingsButton.addEventListener(\"click\", openSettings);\n    }\n\n    if (elements.closeSettingsButton) {\n        elements.closeSettingsButton.addEventListener(\"click\", closeSettings);\n    }\n\n    if (elements.settingsBackdrop) {\n        elements.settingsBackdrop.addEventListener(\"click\", closeSettings);\n    }\n\n    document.addEventListener(\"keydown\", handleGlobalKeydown);\n\n    await populateStoredApiKey();\n    await run();\n}\n\nfunction settingsAreOpen() {\n    return elements.settingsRoot && !elements.settingsRoot.classList.contains(\"settings--hidden\");\n}\n\nfunction openSettings() {\n    if (!elements.settingsRoot) {\n        return;\n    }\n\n    if (!settingsAreOpen()) {\n        settingsReturnFocus = document.activeElement instanceof HTMLElement ? document.activeElement : null;\n    }\n\n    elements.settingsRoot.classList.remove(\"settings--hidden\");\n    elements.settingsRoot.setAttribute(\"aria-hidden\", \"false\");\n\n    if (elements.apiKeyInput) {\n        elements.apiKeyInput.focus();\n        elements.apiKeyInput.select();\n    }\n}\n\nfunction closeSettings() {\n    if (!elements.settingsRoot) {\n        return;\n    }\n\n    elements.settingsRoot.classList.add(\"settings--hidden\");\n    elements.settingsRoot.setAttribute(\"aria-hidden\", \"true\");\n\n    if (settingsReturnFocus && typeof settingsReturnFocus.focus === \"function\") {\n        settingsReturnFocus.focus();\n    }\n\n    settingsReturnFocus = null;\n}\n\nfunction handleGlobalKeydown(event) {\n    if (event.key === \"Escape\" && settingsAreOpen()) {\n        event.preventDefault();\n        closeSettings();\n    }\n}\n\nasync function populateStoredApiKey() {\n    try {\n        const storedKey = await storageGet(API_KEY_STORAGE_KEY);\n        if (storedKey && elements.apiKeyInput) {\n            elements.apiKeyInput.value = storedKey;\n            setApiKeyStatus(\"API key loaded.\", \"success\");\n        }\n    } catch (error) {\n        setApiKeyStatus(`Unable to load saved key: ${error.message}`, \"error\");\n    }\n}\n\nasync function handleSaveApiKey() {\n    if (!elements.apiKeyInput) {\n        return;\n    }\n\n    const key = elements.apiKeyInput.value.trim();\n\n    if (!key) {\n        setApiKeyStatus(\"Enter an API key before saving.\", \"error\");\n        elements.apiKeyInput.focus();\n        return;\n    }\n\n    try {\n        await storageSet(API_KEY_STORAGE_KEY, key);\n        setApiKeyStatus(\"API key saved locally.\", \"success\");\n    } catch (error) {\n        setApiKeyStatus(`Unable to save key: ${error.message}`, \"error\");\n    }\n}\n\nasync function handleClearApiKey() {\n    if (!elements.apiKeyInput) {\n        return;\n    }\n\n    try {\n        await storageRemove(API_KEY_STORAGE_KEY);\n        elements.apiKeyInput.value = \"\";\n        setApiKeyStatus(\"API key removed.\", \"success\");\n    } catch (error) {\n        setApiKeyStatus(`Unable to remove key: ${error.message}`, \"error\");\n    }\n}\n\nfunction setButtonLabel(button, text) {\n    if (!button) {\n        return;\n    }\n\n    const labelElement = button.querySelector(BUTTON_LABEL_SELECTOR);\n    if (labelElement) {\n        labelElement.textContent = text;\n    } else {\n        button.textContent = text;\n    }\n}\n\nfunction setApiKeyStatus(message, type = \"info\") {\n    if (!elements.apiKeyStatus) {\n        return;\n    }\n\n    elements.apiKeyStatus.textContent = message || \"\";\n    elements.apiKeyStatus.classList.remove(\"error\", \"success\");\n\n    if (type === \"error\") {\n        elements.apiKeyStatus.classList.add(\"error\");\n    } else if (type === \"success\") {\n        elements.apiKeyStatus.classList.add(\"success\");\n    }\n}\n\nfunction setStatus(message, type = \"info\") {\n    if (!elements.statusText) {\n        return;\n    }\n\n    elements.statusText.textContent = message || \"\";\n    elements.statusText.classList.remove(\"error\", \"success\");\n\n    if (type === \"error\") {\n        elements.statusText.classList.add(\"error\");\n    } else if (type === \"success\") {\n        elements.statusText.classList.add(\"success\");\n    }\n}\n\nfunction toggleRunButton(isBusy) {\n    if (!elements.runButton) {\n        return;\n    }\n\n    elements.runButton.disabled = isBusy;\n    setButtonLabel(elements.runButton, isBusy ? RUN_LABEL_BUSY : RUN_LABEL_IDLE);\n}\n\nfunction hideSummary() {\n    if (elements.summaryContainer) {\n        elements.summaryContainer.hidden = true;\n    }\n}\n\nfunction renderSummary(summary) {\n    if (!elements.summaryContainer || !elements.todoList || !elements.fyiList) {\n        return;\n    }\n\n    renderList(elements.todoList, summary.todo);\n    renderList(elements.fyiList, summary.fyi);\n    elements.summaryContainer.hidden = false;\n}\n\nfunction renderList(container, items) {\n    if (!container) {\n        return;\n    }\n\n    container.innerHTML = \"\";\n\n    if (!items.length) {\n        const emptyItem = document.createElement(\"li\");\n        emptyItem.textContent = \"Nothing to report.\";\n        emptyItem.classList.add(\"summary-list__empty\");\n        container.appendChild(emptyItem);\n        return;\n    }\n\n    items.forEach((entry) => {\n        const listItem = document.createElement(\"li\");\n        listItem.textContent = entry;\n        container.appendChild(listItem);\n    });\n}\n\nfunction prepareBody(body) {\n    if (body.length <= MAX_EMAIL_CHARACTERS) {\n        return { text: body, truncated: false };\n    }\n\n    return {\n        text: body.slice(0, MAX_EMAIL_CHARACTERS),\n        truncated: true\n    };\n}\n\nfunction getBodyText(item) {\n    return new Promise((resolve, reject) => {\n        if (!item || !item.body) {\n            resolve(\"\");\n            return;\n        }\n\n        item.body.getAsync(Office.CoercionType.Text, (result) => {\n            if (result.status === Office.AsyncResultStatus.Succeeded) {\n                resolve(result.value || \"\");\n            } else {\n                reject(new Error(result.error ? result.error.message : \"Unknown error retrieving email body.\"));\n            }\n        });\n    });\n}\n\nasync function requestSummary({ apiKey, subject, from, body, truncated }) {\n    const metadataLines = [\n        `Subject: ${subject || \"(no subject)\"}`,\n        from ? `From: ${from}` : null,\n        truncated ? \"Note: The email body was truncated for length. Base the summary on the provided content only.\" : null,\n        \"Email body:\",\n        body\n    ].filter(Boolean);\n\n    const payload = {\n        model: \"gpt-3.5-turbo\",\n        temperature: 0.2,\n        max_tokens: 300,\n        messages: [\n            {\n                role: \"system\",\n                content: 'You help busy people process email. Always respond with strictly valid JSON using the shape {\"todo\":[],\"fyi\":[]} where each array contains short sentence strings. Never include any additional commentary.'\n            },\n            {\n                role: \"user\",\n                content: \"Summarize the email into actionable to-do items and FYI notes.\"\n            },\n            {\n                role: \"user\",\n                content: metadataLines.join(\"\\n\")\n            }\n        ]\n    };\n\n    const response = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${apiKey}`\n        },\n        body: JSON.stringify(payload)\n    });\n\n    const responseText = await response.text();\n    let responseJson = null;\n\n    try {\n        responseJson = JSON.parse(responseText);\n    } catch (error) {\n        // Ignore parse failure here; handled below if needed\n    }\n\n    if (!response.ok) {\n        const apiError = responseJson && responseJson.error && responseJson.error.message ? responseJson.error.message : response.statusText;\n        throw new Error(`OpenAI request failed (${response.status}): ${apiError}`);\n    }\n\n    const content = responseJson && responseJson.choices && responseJson.choices[0] && responseJson.choices[0].message\n        ? responseJson.choices[0].message.content\n        : null;\n\n    if (!content) {\n        throw new Error(\"OpenAI response did not include summary content.\");\n    }\n\n    return content;\n}\n\nfunction parseSummaryResponse(rawContent) {\n    const firstBrace = rawContent.indexOf(\"{\");\n    const lastBrace = rawContent.lastIndexOf(\"}\");\n\n    if (firstBrace === -1 || lastBrace === -1) {\n        throw new Error(\"Model response was not valid JSON.\");\n    }\n\n    const jsonText = rawContent.slice(firstBrace, lastBrace + 1);\n\n    let parsed;\n    try {\n        parsed = JSON.parse(jsonText);\n    } catch (error) {\n        throw new Error(\"Unable to parse model response.\");\n    }\n\n    const normalized = {};\n    Object.keys(parsed).forEach((key) => {\n        normalized[key.toLowerCase()] = parsed[key];\n    });\n\n    return {\n        todo: normalizeStringArray(normalized.todo),\n        fyi: normalizeStringArray(normalized.fyi)\n    };\n}\n\nfunction normalizeStringArray(value) {\n    if (!value) {\n        return [];\n    }\n\n    if (Array.isArray(value)) {\n        return value\n            .map((entry) => String(entry).trim())\n            .filter((entry) => entry.length > 0);\n    }\n\n    if (typeof value === \"string\") {\n        return value\n            .split(/\\r?\\n/)\n            .map((entry) => entry.trim())\n            .filter((entry) => entry.length > 0);\n    }\n\n    return [];\n}\n\nasync function storageGet(key) {\n    if (typeof OfficeRuntime !== \"undefined\" && OfficeRuntime.storage) {\n        return OfficeRuntime.storage.getItem(key);\n    }\n\n    return window.localStorage.getItem(key);\n}\n\nasync function storageSet(key, value) {\n    if (typeof OfficeRuntime !== \"undefined\" && OfficeRuntime.storage) {\n        return OfficeRuntime.storage.setItem(key, value);\n    }\n\n    window.localStorage.setItem(key, value);\n}\n\nasync function storageRemove(key) {\n    if (typeof OfficeRuntime !== \"undefined\" && OfficeRuntime.storage) {\n        return OfficeRuntime.storage.removeItem(key);\n    }\n\n    window.localStorage.removeItem(key);\n}\n\nexport async function run() {\n    toggleRunButton(true);\n    setStatus(\"Summarizing the email...\");\n    hideSummary();\n\n    try {\n        const apiKey = await storageGet(API_KEY_STORAGE_KEY);\n        if (!apiKey) {\n            setStatus(\"Add your OpenAI API key in settings before summarizing.\", \"error\");\n            setApiKeyStatus(\"No API key saved.\", \"error\");\n            openSettings();\n            return;\n        }\n\n        const item = Office.context.mailbox.item;\n        if (!item) {\n            throw new Error(\"No email selected.\");\n        }\n\n        const subject = item.subject || \"\";\n        const from = item.from && (item.from.displayName || item.from.emailAddress)\n            ? [item.from.displayName, item.from.emailAddress].filter(Boolean).join(\" \")\n            : \"\";\n        const body = await getBodyText(item);\n        const trimmedBody = body.trim();\n\n        if (!trimmedBody) {\n            setStatus(\"This email does not contain readable content to summarize.\", \"error\");\n            return;\n        }\n\n        const preparedBody = prepareBody(trimmedBody);\n        const rawSummary = await requestSummary({\n            apiKey,\n            subject,\n            from,\n            body: preparedBody.text,\n            truncated: preparedBody.truncated\n        });\n\n        const summary = parseSummaryResponse(rawSummary);\n        renderSummary(summary);\n        setStatus(preparedBody.truncated ? \"Summary ready (email truncated for length).\" : \"Summary ready.\", \"success\");\n    } catch (error) {\n        console.error(error);\n        setStatus(`Unable to summarize email: ${error.message}`, \"error\");\n        hideSummary();\n    } finally {\n        toggleRunButton(false);\n    }\n}\r\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/settings.svg\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Outlook Summarize</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"app-shell ms-Fabric ms-font-m\\\"> <button id=\\\"open-settings\\\" class=\\\"settings-button\\\" type=\\\"button\\\" aria-label=\\\"Open settings\\\"> <img src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"\\\" width=\\\"18\\\" height=\\\"18\\\"/> </button> <section id=\\\"sideload-msg\\\" class=\\\"app-message\\\"> <h2>Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> the add-in to see the task pane.</h2> </section> <main id=\\\"app-body\\\" class=\\\"app\\\" style=\\\"display:none\\\"> <section class=\\\"card card--action\\\"> <button id=\\\"run\\\" type=\\\"button\\\" class=\\\"button button--hero\\\"> <span data-button-label>Summarize email</span> </button> <div id=\\\"status\\\" class=\\\"status-text\\\" role=\\\"status\\\" aria-live=\\\"polite\\\"></div> </section> <section id=\\\"summary\\\" class=\\\"card card--summary\\\" hidden> <div class=\\\"summary-grid\\\"> <article class=\\\"summary-column\\\"> <h3>To-Do</h3> <ul id=\\\"todo-list\\\" class=\\\"summary-list\\\"></ul> </article> <article class=\\\"summary-column\\\"> <h3>FYI</h3> <ul id=\\\"fyi-list\\\" class=\\\"summary-list\\\"></ul> </article> </div> </section> </main> <div id=\\\"settings\\\" class=\\\"settings settings--hidden\\\" aria-hidden=\\\"true\\\"> <div class=\\\"settings__backdrop\\\" role=\\\"presentation\\\"></div> <div class=\\\"settings__panel\\\" role=\\\"dialog\\\" aria-modal=\\\"true\\\" aria-labelledby=\\\"settings-title\\\"> <header class=\\\"settings__header\\\"> <div> <h2 id=\\\"settings-title\\\">Settings</h2> <p class=\\\"settings__hint\\\">Securely store your OpenAI API key on this device.</p> </div> <button id=\\\"close-settings\\\" type=\\\"button\\\" class=\\\"settings__close\\\" aria-label=\\\"Close settings\\\"> <svg viewBox=\\\"0 0 20 20\\\" focusable=\\\"false\\\" aria-hidden=\\\"true\\\"> <path d=\\\"m5.3 5.3 9.4 9.4m0-9.4-9.4 9.4\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"1.6\\\" stroke-linecap=\\\"round\\\"/> </svg> </button> </header> <div class=\\\"settings__body\\\"> <label class=\\\"settings__label\\\" for=\\\"api-key-input\\\">OpenAI API key</label> <input id=\\\"api-key-input\\\" type=\\\"password\\\" class=\\\"input\\\" placeholder=\\\"sk-...\\\" autocomplete=\\\"off\\\"/> <div class=\\\"settings__actions\\\"> <button id=\\\"save-key\\\" type=\\\"button\\\" class=\\\"button button--primary\\\"> <span data-button-label>Save key</span> </button> <button id=\\\"clear-key\\\" type=\\\"button\\\" class=\\\"button button--ghost\\\"> <span data-button-label>Remove key</span> </button> </div> <div id=\\\"api-key-status\\\" class=\\\"status-text\\\" role=\\\"status\\\" aria-live=\\\"polite\\\"></div> </div> </div> </div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","API_KEY_STORAGE_KEY","elements","runButton","statusText","summaryContainer","todoList","fyiList","apiKeyInput","saveKeyButton","clearKeyButton","apiKeyStatus","settingsRoot","openSettingsButton","closeSettingsButton","settingsBackdrop","settingsReturnFocus","_initializeTaskPane","_callee","sideloadMessage","appBody","_context","getElementById","style","display","querySelector","addEventListener","run","handleSaveApiKey","handleClearApiKey","openSettings","closeSettings","handleGlobalKeydown","populateStoredApiKey","settingsAreOpen","classList","contains","activeElement","HTMLElement","remove","setAttribute","focus","select","add","event","preventDefault","_populateStoredApiKey","_callee2","storedKey","_t","_context2","storageGet","setApiKeyStatus","concat","message","_handleSaveApiKey","_callee3","_t2","_context3","trim","storageSet","_handleClearApiKey","_callee4","_t3","_context4","storageRemove","type","textContent","setStatus","toggleRunButton","isBusy","disabled","button","text","labelElement","setButtonLabel","hideSummary","hidden","renderSummary","summary","renderList","todo","fyi","container","items","innerHTML","emptyItem","createElement","appendChild","forEach","entry","listItem","prepareBody","body","truncated","slice","getBodyText","item","reject","getAsync","Office","CoercionType","Text","result","status","AsyncResultStatus","Succeeded","error","requestSummary","_x","_requestSummary","_callee5","_ref","apiKey","subject","from","metadataLines","payload","response","responseText","responseJson","apiError","content","_context5","filter","Boolean","model","temperature","max_tokens","messages","role","join","fetch","method","headers","Authorization","JSON","stringify","parse","ok","choices","parseSummaryResponse","rawContent","firstBrace","indexOf","lastBrace","lastIndexOf","parsed","jsonText","normalized","keys","toLowerCase","normalizeStringArray","Array","isArray","map","String","split","_x2","_storageGet","_callee6","_context6","OfficeRuntime","storage","getItem","localStorage","_x3","_x4","_storageSet","_callee7","_context7","setItem","_x5","_storageRemove","_callee8","_context8","removeItem","_run","_callee9","trimmedBody","preparedBody","_t4","_context9","context","mailbox","emailAddress","console","onReady","info","host","HostType","Outlook","initializeTaskPane","catch","URL"],"sourceRoot":""}